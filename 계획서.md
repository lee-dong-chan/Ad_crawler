## 목표

- 모바일 게임을 이용하는 도중에 발생하는 허위게임 또는 부적절한 게임 광고의 영상 및 스크립트를 자동적으로 수집할수 있는 방안에대한 계획을 수립하고 프로젝트의 방향을 결정

## 보유기기

- 모바일 디바이스
  - 아이폰
- 실행 디바이스
  - Mac

## 준비사항

- idevicelog를 사용하여 아이폰의 로그를 연결
  - 해당 연결을 통하여 아이폰이 앱과 통신할때의 로그를 추출할 수 있음

## 앱 광고의 유형

- 스테이지 종료 후 자동으로 광고를 실행하거나 사용자의 조작을 통하여 광고를 실행하고 해당 광고의 다운로드 스토어 링크를 전달하여 다운로드를 유도함
- (** 조작형 광고로 인하여 자동적인 수집이 어려움 **)

## 앱광고 시스템에대한 가설

- 앱광고의 시스템에대한 가설
  - 게임광고의 경우에 게임광고 영상을 송출하고 영상 송출이 끝나 다운로드 버튼을 조작하면 해당 게임을 설치하는 앱스토어로 연결되는 동작을 수행한다.
  - 이를 통하여 게임광고의 공급자가 게임앱쪽으로 게임 영상 송출을 담당하는 url 과 해당게임의 스토어 설치 페이지로 연결되는 두가지의 url를 전송한다고 예상할 수 있다.

## 앱상에서 수집해야할 요소

- 해당 광고 동영상 송출하는 url 또는 영상
- 해당 광고를 통하여 게임을 설치하기위해 스토어로 연결되는 url

## 광고 Url의 수집 방안 가설과 테스트

### iOS

- 프록시 도구를 통하여 게임으로 전달되는 URL 수집  **Charles Proxy , Frida**

  - 라이센스가 필요하여 해당 방안은 보류ff

- idevicelog 통하여 아이폰이 실행하는 해당 앱의 로그를 조회하여 url 수집(대체 방안)
  - 스토어 url을 표시할때 해당 url에서 앱의 스토어 id를 획득이 가능
    - node.js의 child_process를 사용하여 다운로드 버튼 동작시 발생하는 네트워크로그를 분석하여 스토어의 url 추출
    - https://amp-api.apps.apple.com/v1/catalog/kr/apps/ 다운로드 링크 작동시 해당 url 뒤로 스토어 아이디가 전송됨
    - 해당 url은 앱내부에서 동작하여 웹에서는 작동이 안되므로 Url에 존재하는 id 값을 추출하여 해당 앱의 스토어 페이지를 추적
  - 동영상이 전달되는 URL은 접근이 불가능
    - 화면 녹화를 통한 영상수집으로 계획 변경

## 해당 게임이 부적절하거나 허위게임인지 판단할 방안에대한 가설

- 직접 게임을 플레이하여 해당 게임을 판별할 수 없음
- 스토어의 리뷰를 탐색한 결과 1점대 리뷰에서 해당 허위게임 및 과장광고에 대한 사용자의 피드백 리뷰를 확인할수 있었음.
- 해당 리뷰들을 통하여 목록을 필터링하면 해당 게임이 광고와 불일치하는 비정상적 게임을 1차적으로 필터링할수 있을것으로 예상함

## 해당 게임 스토어의 리뷰목록 수집 방안

- 아이폰의 log 에서 추출한 딥링크의 스토어 url을 크롤러에 전달하여 스토어상의 해당 게임의 리뷰목록을 크롤링 하도록 구현

## 게임 리뷰를 통하여 영상 및 스크립트의 URL 목록의 1차 필터링

- 추출한 리뷰목록을 키워드를 검열하여 해당 게임이 정상적인 게임인지 판별하여 문제가 있으면 2차 필터링 진행

## 영상 및 스크립트의 URL 2차 필터링

- 1차 필터링된 영상을 분석하여 부적절한 광고영상일경우 파일이름,파일경로 스토어id를 반환하여 DB 테이블에 저장되도록 구현

## 영상을 수집할 방안

- url을 통한 영상 수집(접근이 불가하여 실패)
- 광고영상을 송출시 발생하는 로그를 트리거로 하여 모바일 디바이스에 요청을 보내 화면을 녹화하도록 하여 영상을 추출 (대체방안)
  - 해당 로그는 여러번 발생하기 때문에 요청후 화면녹화가 진행되는동안 해당 요청을 무시하도록 구현이 필요함
  - 아이폰의 단축어 기능 + node.js을 통하여 화면녹화 (아이폰 보안상 권한 접근금지)
  - Mac QuickTime player를 통하여 아이폰화면을 송출하고 Applescript와 node.js를 결합하여 녹화를 제어 하여 영상 수집(현재)
  - 수집 문제사항
    - 특정광고는 화면녹화를 감지하여 영상송출 중단
    - 조작형 광고로 자동수집에 문제사항 발생

## 영상을 분석하여 2차 필터링 가설

- 영상의 음성을 문서화하여 AI 모델,영상의 선정성등 검열하는 AI 모델,광고영상에서 텍스트 정보를 추출하는 AI모델을 조합하여 순차적으로 검열을 진행하고 통과하지 못한 영상의 게임이름과 영상파일 이름을 DB에 저장하고 검열에서 문제가 없는 영상은 삭제
